---
title: "Final Report"
subtitle: "Experiments and Causality"
author: "Colby Carter, Abhishek Agarwal, Tiffany Jaya"
date: \today
output: pdf_document
---

## Load the libraries

```{r, message=FALSE}
library(data.table) # fread
library(dplyr)
library(geonames)
library(lmtest) # coeftest
library(lubridate) # time conversion
library(sandwich) # vcovHC
library(RJSONIO)
```

## Helper functions

```{r}
convert_fctr_to_boolean <- function(col) {
  return(as.numeric(as.logical(col)))
}

convert_fctr_to_datetime <- function(col) {
  return(as.POSIXct(col, format="%Y-%m-%d %H:%M:%S"))
}

convert_fctr_to_numeric <- function(col) {
  return(as.numeric(levels(col)[col]))
}

convert_fctr_to_str <- function(col) {
  return(as.character(col))
}
```

## Load the dataset

```{r}
# pilot study
d <- read.csv(file = "./W241 Colby Carter, Tiffany Jaya, Abhishek Agarwal_April 5, 2018_00.27.csv",
              header = TRUE, 
              sep = ",")
```

```{r}
# actual study
d <- read.csv(file = "./W241 Colby Carter, Tiffany Jaya, Abhishek Agarwal_April 12, 2018_09.41.csv",
              header = TRUE, 
              sep = ",")
```

## Clean up the dataset

**WARNING: DO NOT RERUN THIS SECTION TWICE!**

```{r}
# rename columns to be more descriptive
setnames(d, 
         old = c("Q1.1", 
                 "Q2.2_1",
                 "Q2.3_1",
                 "Q2.5_1",
                 "Q2.7_1",
                 "Q3.1_1", 
                 "Q3.3_1",
                 "Q3.5_1",
                 "Q3.7_1",
                 "Q4.1",
                 "Q4.2",
                 "Q4.3",
                 "Q4.4",
                 "Q4.5",
                 "Q4.6",
                 "Q4.7",
                 "Q4.8",
                 "Q4.9",
                 "Q4.10",
                 "Q4.11",
                 "Q4.12",
                 "Q4.13",
                 "Q4.14",
                 "Q4.15",
                 "Q4.16", 
                 "Q2.1_First.Click",
                 "Q2.1_Last.Click",
                 "Q2.1_Page.Submit",
                 "Q2.1_Click.Count",
                 "Q2.4_First.Click",
                 "Q2.4_Last.Click",
                 "Q2.4_Page.Submit",
                 "Q2.4_Click.Count",
                 "Q2.6_First.Click",
                 "Q2.6_Last.Click",
                 "Q2.6_Page.Submit",
                 "Q2.6_Click.Count",
                 "Q2.8_First.Click",
                 "Q2.8_Last.Click",
                 "Q2.8_Page.Submit",
                 "Q2.8_Click.Count",
                 "Q3.2_First.Click",
                 "Q3.2_Last.Click",
                 "Q3.2_Page.Submit",
                 "Q3.2_Click.Count",
                 "Q3.4_First.Click",
                 "Q3.4_Last.Click",
                 "Q3.4_Page.Submit",
                 "Q3.4_Click.Count",
                 "Q3.6_First.Click",
                 "Q3.6_Last.Click",
                 "Q3.6_Page.Submit",
                 "Q3.6_Click.Count",
                 "Q3.8_First.Click",
                 "Q3.8_Last.Click",
                 "Q3.8_Page.Submit",
                 "Q3.8_Click.Count"),
         new = c("consent", 
                 "control_employment",
                 "control_education", # baseline
                 "control_retirement",
                 "control_cybersecurity",
                 "treatment_employment",
                 "treatment_education", # baseline,
                 "treatment_retirement",
                 "treatment_cybersecurity",
                 "gender",
                 "age",
                 "highest_education",
                 "employment_status",
                 "marital_status",
                 "zip_code",
                 "community", # rural, urban, suburban
                 "can_vote",
                 "political_party",
                 "ethnicity",
                 "income",
                 "have_kids",
                 "internet_from_mobile",
                 "internet_from_home",
                 "internet_from_work",
                 "who_pays_internet",
                 "control_employment_First.Click",
                 "control_employment_Last.Click",
                 "control_employment_Page.Submit",
                 "control_employment_Click.Count",
                 "control_education_First.Click",
                 "control_education_Last.Click",
                 "control_education_Page.Submit",
                 "control_education_Click.Count",
                 "control_retirement_First.Click",
                 "control_retirement_Last.Click",
                 "control_retirement_Page.Submit",
                 "control_retirement_Click.Count",
                 "control_cybersecurity_First.Click",
                 "control_cybersecurity_Last.Click",
                 "control_cybersecurity_Page.Submit",
                 "control_cybersecurity_Click.Count",
                 "treatment_employment_First.Click",
                 "treatment_employment_Last.Click",
                 "treatment_employment_Page.Submit",
                 "treatment_employment_Click.Count",
                 "treatment_education_First.Click",
                 "treatment_education_Last.Click",
                 "treatment_education_Page.Submit",
                 "treatment_education_Click.Count",
                 "treatment_retirement_First.Click",
                 "treatment_retirement_Last.Click",
                 "treatment_retirement_Page.Submit",
                 "treatment_retirement_Click.Count",
                 "treatment_cybersecurity_First.Click",
                 "treatment_cybersecurity_Last.Click",
                 "treatment_cybersecurity_Page.Submit",
                 "treatment_cybersecurity_Click.Count"))
```

```{r}
# 1. remove the first two rows
d <- tail(d, -2)
# 2. remove rownames to avoid confusion (because it is not the subject's id)
rownames(d) <- NULL
# 3. safely convert columns of type factors to their respective types
# 3a. factor -> datetime
cols <- c("StartDate", "EndDate", "RecordedDate")
d[,cols] <- lapply(d[,cols], convert_fctr_to_datetime)
# 3b. factor -> logical/boolean
cols <- c("Finished")
d[,cols] <- lapply(d[,cols], convert_fctr_to_boolean)
d$consent <- ifelse(d$consent == "Yes", 1, 0)
d$can_vote <- ifelse(d$can_vote == "Yes", 1, 0)
d$have_kids <- ifelse(d$have_kids == "Yes", 1, 0)
# 3c. factor -> numeric
cols <- c("Progress", 
          "Duration..in.seconds.", 
          "LocationLatitude", 
          "LocationLongitude",
          "control_employment", 
          "control_education", 
          "control_retirement", 
          "control_cybersecurity",
          "treatment_employment", 
          "treatment_education", 
          "treatment_retirement", 
          "treatment_cybersecurity",
          "zip_code",
          "control_employment_First.Click", 
          "control_employment_Last.Click", 
          "control_employment_Page.Submit", 
          "control_employment_Click.Count", 
          "control_education_First.Click",
          "control_education_Last.Click",
          "control_education_Page.Submit",
          "control_education_Click.Count",
          "control_retirement_First.Click",
          "control_retirement_Last.Click",
          "control_retirement_Page.Submit",
          "control_retirement_Click.Count",
          "control_cybersecurity_First.Click",
          "control_cybersecurity_Last.Click",
          "control_cybersecurity_Page.Submit",
          "control_cybersecurity_Click.Count",
          "treatment_employment_First.Click",
          "treatment_employment_Last.Click",
          "treatment_employment_Page.Submit",
          "treatment_employment_Click.Count",
          "treatment_education_First.Click",
          "treatment_education_Last.Click",
          "treatment_education_Page.Submit",
          "treatment_education_Click.Count",
          "treatment_retirement_First.Click",
          "treatment_retirement_Last.Click",
          "treatment_retirement_Page.Submit",
          "treatment_retirement_Click.Count",
          "treatment_cybersecurity_First.Click",
          "treatment_cybersecurity_Last.Click",
          "treatment_cybersecurity_Page.Submit",
          "treatment_cybersecurity_Click.Count"
          )
d[,cols] <- lapply(d[,cols], convert_fctr_to_numeric)
# 3d. factor -> str
cols <- c("IPAddress", "ResponseId", "UserLanguage", "highest_education")
d[,cols] <- lapply(d[,cols], convert_fctr_to_str)
```

## Add additional information into the dataset

```{r, echo=FALSE}
# login information
options(geonamesUsername="sullivannicole")
```

```{r}
# get country information based on latlong
country_names <- mapply(
  function(lat, long) {
    suppressWarnings(try(GNcountryCode(lat, long)$countryName, silent = TRUE))
  }, d$LocationLatitude, d$LocationLongitude)
d$country <- country_names
```

## List all the columns

```{r}
colnames(d)
```

## Analysis

data: contains the original dataset
```{r}
# save a copy of the original dataset
data <- d
```

### Filter

d: contains the dataset after we filtered out for the following:

1. subjects who did not finish the survey 100%
2. subjects who consented to take the survey

```{r}
# filter for subjects who consented to take the survey
d <- d[which(d$consent == 1),]
```

3. subjects who are from USA

```{r}
# filter for subjects who are from USA
d <- d %>% filter(., country == "United States")
```

4. subjects who took the survey once

```{r}
# filter out subjects who took the survey more than once
subjects.repeater <- d %>% group_by(IPAddress) %>% summarize(freq = sum(n())) %>% filter(freq > 1)
d <- d %>% filter(!(IPAddress %in% subjects.repeater$IPAddress))
```

### How many took the survey?

```{r}
# how many subjects take the survey?
nrow(data)
```

638 subjects take the survey.

### Verify that ResponseId is unique

```{r}
# is ResponseId unique? 
# if yes, use ResponseId as a unique id
freq_responseid <- data %>% group_by(ResponseId) %>% summarize(freq = sum(n()))
sum(freq_responseid$freq > 1) == 0
```

ResponseId is unique. 

### Verify that all the subjects completed the survey

```{r}
# how many subjects did not finish the survey?
sum(!data$Finished)
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the progress of each subject
hist(data$Progress, 
     xlab = "progress (%)",
     ylab = "number of users",
     breaks = -0.5:100.5, 
     ylim = c(0, 700),
     labels = TRUE)
```

All of the subjects completed the survey. 

### Verify that all subjects completed the survey in reasonable time (greater than 2 minutes)

```{r}
# how long does it take the subjects who consented to finish the survey in minutes?
subjects.consent <- data[which(data$consent == 1),]
summary(subjects.consent$Duration..in.seconds./60)
```

The following checks are unnecessary:

```{r}
# list all the subjects who take less than 2 minutes to finish the survey
subjects.less_2_min <- data[which(data$Duration..in.seconds./60 < 2),]
nrow(subjects.less_2_min)
```

```{r}
# list all subjects who did not consent
subjects.no_consent <- data[which(data$consent == 0),]
nrow(subjects.no_consent)
```

```{r}
# verify that the subjects who did not consent 
# match the subjects who took the survey in less than 2 minutes
all(subjects.less_2_min$ResponseId %in% subjects.no_consent$ResponseId)
```

### Verify that all subjects have English set as their language

```{r}
# list all languages not in English
data[which(data$UserLanguage != "EN"),]$UserLanguage
```

### Verify that all subjects are from United States

```{r}
# how many subjects are from United States?
data %>% filter(., country == "United States") %>% count(.)
# how many subjects are from outside the United States?
data %>% filter(., country != "United States") %>% count(.)
```

Out of 638 subjects, 580 subjects are from the United States and 58 are from outside the United States.

### Verify that subjects only took the survey once

```{r}
subjects.repeater
```

All devices connected to the same router will share the same external IP address.

```{r}
d %>% filter(IPAddress == "170.185.202.19")
```

It might be that the two women who took the survey are roommates, but since we have no way to confirm, it is better not to use this dataset in the study.

```{r}
d %>% filter(IPAddress == "24.46.117.154")
```

It's simply not possible that different people with different zip codes to have the same IP address. The reliability of this data is questionable. It might be possible that friends come over to take the same survey, but since we have no way to confirm, it is better not to use this dataset in the study.

```{r}
d %>% filter(IPAddress == "50.88.107.50")
```

With the same reasoning as above, it is better not to use this dataset.

```{r}
d %>% filter(IPAddress == "67.183.210.112")
```

With the same reasoning as above, it is better not to use this dataset.

### Verify that subjects answer all the questions

```{r}
# check if subjects in control answer all questions
d %>%
  select(control_employment, control_education, control_retirement, control_cybersecurity) %>%
  summarise_all(funs(sum(!is.na(.))))
```

Yes, subjects in control answer all the questions. There are 262 subjects in control.

```{r}
# check if subjects in treatment answer all questions
d %>%
  select(treatment_employment, treatment_education, treatment_retirement, treatment_cybersecurity) %>%
  summarise_all(funs(sum(!is.na(.))))
```

Yes, subjects in treatment answer all the questions. There are 295 subjects in treatment.

### Separate between treatment and control

```{r}
# filter for subjects in control
control <- d %>% filter(!is.na(control_employment) & 
                        !is.na(control_education) & 
                        !is.na(control_retirement) & 
                        !is.na(control_cybersecurity))
```

```{r}
# verify that control has 262 subjects
nrow(control) == 262
```

```{r}
# filter for subjects in treatment
treatment <- d %>% filter(!is.na(treatment_employment) & 
                          !is.na(treatment_education) & 
                          !is.na(treatment_retirement) & 
                          !is.na(treatment_cybersecurity))
```
```{r}
# verify that treatment has 295 subjects
nrow(treatment) == 295
```

### Explore the covariates

1. Gender: 
   There is slightly more male than female in the control group.
   There is slightly more female than male in the control group.
   Overall, they're equally distributed.

2. Age: 
   Age has a positively skewed distribution with subjects mostly in the age range of 25-34. 
   The distribution is approximately equal in treatment and control.
  
3. Highest education:
   The majority of the survey takers have a 4 year degree. 
   The distribution is approximately equal in treatment and control. 

4. Employment status:
   The majority of the subjects are employed full time. 
   The distribution is approximately equal in treatment and control.

5. Marital status:
   The majority of the participants are married, followed by them being never married. 
   The distribution is approximately equal in treatment and control. 

6. Zip code:


7. Community:
   Subjects are twice more likely to live in suburban than in rural or urban communities. 
   The distribution is approximately equal in treatment and control. 

8. Can vote: 
   Approximately 12% of the subjects cannot vote. 
   There are more subjects who cannot vote in the treatment group than in the control group, 
   but the majority of the people can vote. 

9. Political party:
   There are in general more Democrats taking the survey 
   followed by Independents then Republicans last.

10. Ethnicity: 
    The majority of the subjects are white. 
    The distribution is approximately equal in treatment and control.

11. Income: 
    The majority of the subjects make income around $20,000 - $49,999 range. 
    The distribution is positively skewed. 
    Treatment seems to have a slightly higher income overall but not by much.

12. Have kids:
    There are slightly more subjects having kids than no kids but not by much.

13. Internet access via mobile phone: 
    The majority of the subjects access their phone daily.

14. Internet access from home:
    The majority of the subjects access their internet daily from their home.

15. Internet access from work: 
    The majority of the subjects access their internet daily from their work.
    
16. Who pays for the internet:
    The majority of the subjects pay internet by themselves. 

17. Click counts: 
    There are slightly more clicks in treatment than in control.
    Both follow the same distribution, which is high click counts, on average, for the first question 
    then decreasing the number of click counts until the third question 
    before rising up on the fourth question. 
    
18. Duration in the question:
    On average, it takes the treatment group much longer to complete the question than the control group.
    WARNING: It is a little concerning that about half of the subjects in both treatment and control
    answer the question on average less than 30 seconds.


#### 1. Gender

```{r}
# gender frequency in the entire study
(total.gender.freq <- d %>% 
  group_by(gender) %>% 
  summarize(freq = sum(n()))) 
```

```{r}
# percentage of noncompliant for the entire study
total.gender.freq[which(total.gender.freq == ""),]$freq / sum(total.gender.freq$freq) * 100
# percentage of female for the entire study
total.gender.freq[which(total.gender.freq == "Female"),]$freq / sum(total.gender.freq$freq) * 100
# percentage of male for the entire study
total.gender.freq[which(total.gender.freq == "Male"),]$freq / sum(total.gender.freq$freq) * 100
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the gender frequency in the entire study
total.gender.bp <- barplot(total.gender.freq$freq, names.arg=total.gender.freq$gender, ylim=c(0,300))
text(total.gender.bp, 0, round(total.gender.freq$freq, 1), cex=1, pos=3)
```

**TOTAL**
no answer: 1 (0.1795332%)
female: 282 (50.62837%)
male: 274 (49.1921%)

There is almost equal number of male and female in the entire study.

```{r}
# gender frequency in the control group
(control.gender.freq <- control %>% 
  group_by(gender) %>% 
  summarize(freq = sum(n()))) 
```

```{r}
# percentage of noncompliant in the control group
control.gender.freq[which(control.gender.freq == ""),]$freq / sum(control.gender.freq$freq) * 100
# percentage of female in the control group
control.gender.freq[which(control.gender.freq == "Female"),]$freq / sum(control.gender.freq$freq) * 100
# percentage of male in the control group
control.gender.freq[which(control.gender.freq == "Male"),]$freq / sum(control.gender.freq$freq) * 100
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the gender frequency in the control group
control.gender.bp <- barplot(control.gender.freq$freq, names.arg=control.gender.freq$gender, ylim=c(0,300))
text(control.gender.bp, 0, round(control.gender.freq$freq, 1), cex=1, pos=3)
```

**CONTROL**
no answer: 1 (0.3816794%)
female: 127 (48.47328%)
male: 134 (51.14504%)

There is slightly more male than female in the control group.

```{r}
# gender frequency in the treatment group
(treatment.gender.freq <- treatment %>% 
  group_by(gender) %>% 
  summarize(freq = sum(n()))) 
```

```{r}
# percentage of female in the treatment group
treatment.gender.freq[which(treatment.gender.freq == "Female"),]$freq / sum(treatment.gender.freq$freq) * 100
# percentage of male in the treatment group
treatment.gender.freq[which(treatment.gender.freq == "Male"),]$freq / sum(treatment.gender.freq$freq) * 100
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the gender frequency in the treatment group
treatment.gender.bp <- barplot(treatment.gender.freq$freq, names.arg=treatment.gender.freq$gender, ylim=c(0,300))
text(treatment.gender.bp, 0, round(treatment.gender.freq$freq, 1), cex=1, pos=3)
```

**TREATMENT**
female: 155 (52.54237%)
male: 140 (47.45763%)

There is slightly more female than male in the treatment group.

#### 2. Age

```{r}
# age frequency in the entire study
total.age.freq <- d %>% 
  group_by(age) %>% 
  summarize(freq = sum(n()))
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the age frequency in the entire study
total.age.bp <- barplot(total.age.freq$freq, names.arg=total.age.freq$age, ylim=c(0,250))
text(total.age.bp, 0, round(total.age.freq$freq, 1), cex=1, pos=3)
```

```{r}
# age frequency in the control group
control.age.freq <- control %>% 
  group_by(age) %>% 
  summarize(freq = sum(n())) 
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the age frequency in the control group
control.age.bp <- barplot(control.age.freq$freq, names.arg=control.age.freq$age, ylim=c(0,250))
text(control.age.bp, 0, round(control.age.freq$freq, 1), cex=1, pos=3)
```

```{r}
# age frequency in the treatment group
treatment.age.freq <- treatment %>% 
  group_by(age) %>% 
  summarize(freq = sum(n())) 
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the age frequency in the treatment group
treatment.age.bp <- barplot(treatment.age.freq$freq, names.arg=treatment.age.freq$age, ylim=c(0,250))
text(treatment.age.bp, 0, round(treatment.age.freq$freq, 1), cex=1, pos=3)
```

Age has a positively skewed distribution with subjects mostly in the age range of 25-34. The distribution is approximately equal in treatment and control.

#### 3. Highest education

```{r}
highest_education.order <- c("Less than high school", "High school graduate", "Some college", "2 year degree", "4 year degree", "Doctorate", "Professional degree")
```

```{r}
# highest_education frequency in the entire study
total.highest_education.freq <- d %>% 
  group_by(highest_education) %>% 
  summarize(freq = sum(n())) %>%
  left_join(data.frame(highest_education=highest_education.order), .)
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the highest_education frequency in the entire study
par(mar=c(10,3,1,1))
total.highest_education.bp <- barplot(total.highest_education.freq$freq, names.arg=total.highest_education.freq$highest_education, ylim=c(0,200), las=2)
text(total.highest_education.bp, 0, round(total.highest_education.freq$freq, 1), cex=1, pos=3)
```

```{r}
# highest_education frequency in the control group
control.highest_education.freq <- control %>% 
  group_by(highest_education) %>% 
  summarize(freq = sum(n())) %>%
  left_join(data.frame(highest_education=highest_education.order), .)
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the highest_education frequency in the control group
par(mar=c(10,3,1,1))
control.highest_education.bp <- barplot(control.highest_education.freq$freq, names.arg=control.highest_education.freq$highest_education, ylim=c(0,200), las=2)
text(control.highest_education.bp, 0, round(control.highest_education.freq$freq, 1), cex=1, pos=3)
```

```{r}
# highest_education frequency in the treatment group
treatment.highest_education.freq <- treatment %>% 
  group_by(highest_education) %>% 
  summarize(freq = sum(n())) %>%
  left_join(data.frame(highest_education=highest_education.order), .)
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the highest_education frequency in the treatment group
par(mar=c(10,3,1,1))
treatment.highest_education.bp <- barplot(treatment.highest_education.freq$freq, names.arg=treatment.highest_education.freq$highest_education, ylim=c(0,200), las=2)
text(treatment.highest_education.bp, 0, round(treatment.highest_education.freq$freq, 1), cex=1, pos=3)
```

The majority of the survey takers have a 4 year degree. The distribution is approximately equal in treatment and control. 

#### 4. Employment status

```{r}
# employment_status frequency in the entire study
total.employment_status.freq <- d %>% 
  group_by(employment_status) %>% 
  summarize(freq = sum(n()))
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the employment_status frequency in the entire study
par(mar=c(16,3,1,1))
total.employment_status.bp <- barplot(total.employment_status.freq$freq, names.arg=total.employment_status.freq$employment_status, ylim=c(0,400), las=2)
text(total.employment_status.bp, 0, round(total.employment_status.freq$freq, 1), cex=1, pos=3)
```

```{r}
# employment_status frequency in the control group
control.employment_status.freq <- control %>% 
  group_by(employment_status) %>% 
  summarize(freq = sum(n())) 
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the employment_status frequency in the control group
par(mar=c(16,3,1,1))
control.employment_status.bp <- barplot(control.employment_status.freq$freq, names.arg=control.employment_status.freq$employment_status, ylim=c(0,200), las=2)
text(control.employment_status.bp, 0, round(control.employment_status.freq$freq, 1), cex=1, pos=3)
```

```{r}
# employment_status frequency in the treatment group
treatment.employment_status.freq <- treatment %>% 
  group_by(employment_status) %>% 
  summarize(freq = sum(n())) 
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the employment_status frequency in the treatment group
par(mar=c(16,3,1,1))
treatment.employment_status.bp <- barplot(treatment.employment_status.freq$freq, names.arg=treatment.employment_status.freq$employment_status, ylim=c(0,200), las=2)
text(treatment.employment_status.bp, 0, round(treatment.employment_status.freq$freq, 1), cex=1, pos=3)
```

The majority of the subjects are employed full time. The distribution is approximately equal in treatment and control. 

#### 5. Marital status

```{r}
# marital_status frequency in the entire study
total.marital_status.freq <- d %>% 
  group_by(marital_status) %>% 
  summarize(freq = sum(n()))
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the marital_status frequency in the entire study
par(mar=c(7,3,1,1))
total.marital_status.bp <- barplot(total.marital_status.freq$freq, names.arg=total.marital_status.freq$marital_status, ylim=c(0,400), las=2)
text(total.marital_status.bp, 0, round(total.marital_status.freq$freq, 1), cex=1, pos=3)
```

```{r}
# marital_status frequency in the control group
control.marital_status.freq <- control %>% 
  group_by(marital_status) %>% 
  summarize(freq = sum(n())) 
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the marital_status frequency in the control group
par(mar=c(7,3,1,1))
control.marital_status.bp <- barplot(control.marital_status.freq$freq, names.arg=control.marital_status.freq$marital_status, ylim=c(0,200), las=2)
text(control.marital_status.bp, 0, round(control.marital_status.freq$freq, 1), cex=1, pos=3)
```

```{r}
# marital_status frequency in the treatment group
treatment.marital_status.freq <- treatment %>% 
  group_by(marital_status) %>% 
  summarize(freq = sum(n())) 
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the marital_status frequency in the treatment group
par(mar=c(7,3,1,1))
treatment.marital_status.bp <- barplot(treatment.marital_status.freq$freq, names.arg=treatment.marital_status.freq$marital_status, ylim=c(0,200), las=2)
text(treatment.marital_status.bp, 0, round(treatment.marital_status.freq$freq, 1), cex=1, pos=3)
```

The majority of the participants are married, followed by them being never married. The distribution is approximately equal in treatment and control. 

#### 6. Zip code

TODO

#### 7. Community

```{r}
# community frequency in the entire study
total.community.freq <- d %>% 
  group_by(community) %>% 
  summarize(freq = sum(n()))
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the community frequency in the entire study
par(mar=c(7,3,1,1))
total.community.bp <- barplot(total.community.freq$freq, names.arg=total.community.freq$community, ylim=c(0,400), las=2)
text(total.community.bp, 0, round(total.community.freq$freq, 1), cex=1, pos=3)
```

```{r}
# community frequency in the control group
control.community.freq <- control %>% 
  group_by(community) %>% 
  summarize(freq = sum(n())) 
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the community frequency in the control group
par(mar=c(7,3,1,1))
control.community.bp <- barplot(control.community.freq$freq, names.arg=control.community.freq$community, ylim=c(0,200), las=2)
text(control.community.bp, 0, round(control.community.freq$freq, 1), cex=1, pos=3)
```

```{r}
# community frequency in the treatment group
treatment.community.freq <- treatment %>% 
  group_by(community) %>% 
  summarize(freq = sum(n())) 
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the community frequency in the treatment group
par(mar=c(7,3,1,1))
treatment.community.bp <- barplot(treatment.community.freq$freq, names.arg=treatment.community.freq$community, ylim=c(0,200), las=2)
text(treatment.community.bp, 0, round(treatment.community.freq$freq, 1), cex=1, pos=3)
```

Subjects are twice more likely to live in suburban than in rural or urban communities. The distribution is approximately equal in treatment and control. 

#### 8. Can vote

```{r}
# can_vote frequency in the entire study
total.can_vote.freq <- d %>% 
  group_by(can_vote) %>% 
  summarize(freq = sum(n()))
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the can_vote frequency in the entire study
par(mar=c(7,3,1,1))
total.can_vote.bp <- barplot(total.can_vote.freq$freq, names.arg=total.can_vote.freq$can_vote, ylim=c(0,400), las=2)
text(total.can_vote.bp, 0, round(total.can_vote.freq$freq, 1), cex=1, pos=3)
```

```{r}
# can_vote frequency in the control group
control.can_vote.freq <- control %>% 
  group_by(can_vote) %>% 
  summarize(freq = sum(n())) 
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the can_vote frequency in the control group
par(mar=c(7,3,1,1))
control.can_vote.bp <- barplot(control.can_vote.freq$freq, names.arg=control.can_vote.freq$can_vote, ylim=c(0,200), las=2)
text(control.can_vote.bp, 0, round(control.can_vote.freq$freq, 1), cex=1, pos=3)
```

```{r}
# can_vote frequency in the treatment group
treatment.can_vote.freq <- treatment %>% 
  group_by(can_vote) %>% 
  summarize(freq = sum(n())) 
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the can_vote frequency in the treatment group
par(mar=c(7,3,1,1))
treatment.can_vote.bp <- barplot(treatment.can_vote.freq$freq, names.arg=treatment.can_vote.freq$can_vote, ylim=c(0,200), las=2)
text(treatment.can_vote.bp, 0, round(treatment.can_vote.freq$freq, 1), cex=1, pos=3)
```

Approximately 12% of the subjects cannot vote. There are more subjects who cannot vote in the treatment group than in the control group, but the majority of the people can vote. 

#### 9. Political party

```{r}
# political_party frequency in the entire study
total.political_party.freq <- d %>% 
  group_by(political_party) %>% 
  summarize(freq = sum(n()))
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the political_party frequency in the entire study
par(mar=c(10,3,1,1))
total.political_party.bp <- barplot(total.political_party.freq$freq, names.arg=total.political_party.freq$political_party, ylim=c(0,300), las=2)
text(total.political_party.bp, 0, round(total.political_party.freq$freq, 1), cex=1, pos=3)
```

```{r}
# political_party frequency in the control group
control.political_party.freq <- control %>% 
  group_by(political_party) %>% 
  summarize(freq = sum(n())) 
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the political_party frequency in the control group
par(mar=c(10,3,1,1))
control.political_party.bp <- barplot(control.political_party.freq$freq, names.arg=control.political_party.freq$political_party, ylim=c(0,150), las=2)
text(control.political_party.bp, 0, round(control.political_party.freq$freq, 1), cex=1, pos=3)
```

```{r}
# political_party frequency in the treatment group
treatment.political_party.freq <- treatment %>% 
  group_by(political_party) %>% 
  summarize(freq = sum(n())) 
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the political_party frequency in the treatment group
par(mar=c(10,3,1,1))
treatment.political_party.bp <- barplot(treatment.political_party.freq$freq, names.arg=treatment.political_party.freq$political_party, ylim=c(0,150), las=2)
text(treatment.political_party.bp, 0, round(treatment.political_party.freq$freq, 1), cex=1, pos=3)
```

There are in general more Democrats taking the survey followed by Independents then Republicans last.

#### 10. Ethnicity

```{r}
# ethnicity frequency in the entire study
total.ethnicity.freq <- d %>% 
  group_by(ethnicity) %>% 
  summarize(freq = sum(n()))
```

```{r}
total.ethnicity.freq
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the ethnicity frequency in the entire study
par(mar=c(8,3,1,1))
total.ethnicity.bp <- barplot(total.ethnicity.freq$freq, names.arg=total.ethnicity.freq$ethnicity, ylim=c(0,600), las=2)
text(total.ethnicity.bp, 0, round(total.ethnicity.freq$freq, 1), cex=1, pos=3)
```

```{r}
# ethnicity frequency in the control group
control.ethnicity.freq <- control %>% 
  group_by(ethnicity) %>% 
  summarize(freq = sum(n())) 
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the ethnicity frequency in the control group
par(mar=c(8,3,1,1))
control.ethnicity.bp <- barplot(control.ethnicity.freq$freq, names.arg=control.ethnicity.freq$ethnicity, ylim=c(0,250), las=2)
text(control.ethnicity.bp, 0, round(control.ethnicity.freq$freq, 1), cex=1, pos=3)
```

```{r}
# ethnicity frequency in the treatment group
treatment.ethnicity.freq <- treatment %>% 
  group_by(ethnicity) %>% 
  summarize(freq = sum(n())) 
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the ethnicity frequency in the treatment group
par(mar=c(8,3,1,1))
treatment.ethnicity.bp <- barplot(treatment.ethnicity.freq$freq, names.arg=treatment.ethnicity.freq$ethnicity, ylim=c(0,250), las=2)
text(treatment.ethnicity.bp, 0, round(treatment.ethnicity.freq$freq, 1), cex=1, pos=3)
```

The majority of the subjects are white. The distribution is approximately equal in treatment and control. 
#### 11. Income

```{r}
income.order <- c("Less than $10,000", "$10,000 - $19,999", "$20,000 - $29,999", "$30,000 - $39,999",
                  "$40,000 - $49,999", "$50,000 - $59,999", "$60,000 - $69,999", "$70,000 - $79,999",
                  "$80,000 - $89,999", "$90,000 - $99,999", "$100,000 - $149,999", "More than $150,000",
                  "Rather not say")
```

```{r}
# income frequency in the entire study
total.income.freq <- d %>% 
  group_by(income) %>% 
  summarize(freq = sum(n())) %>%
  left_join(data.frame(income=income.order), .)
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the income frequency in the entire study
par(mar=c(10,3,1,1))
total.income.bp <- barplot(total.income.freq$freq, names.arg=total.income.freq$income, ylim=c(0,100), las=2)
text(total.income.bp, 0, round(total.income.freq$freq, 1), cex=1, pos=3)
```

```{r}
# income frequency in the control group
control.income.freq <- control %>% 
  group_by(income) %>% 
  summarize(freq = sum(n())) %>%
  left_join(data.frame(income=income.order), .)
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the income frequency in the control group
par(mar=c(10,3,1,1))
control.income.bp <- barplot(control.income.freq$freq, names.arg=control.income.freq$income, ylim=c(0,50), las=2)
text(control.income.bp, 0, round(control.income.freq$freq, 1), cex=1, pos=3)
```

```{r}
# income frequency in the treatment group
treatment.income.freq <- treatment %>% 
  group_by(income) %>% 
  summarize(freq = sum(n())) %>%
  left_join(data.frame(income=income.order), .)
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the income frequency in the treatment group
par(mar=c(10,3,1,1))
treatment.income.bp <- barplot(treatment.income.freq$freq, names.arg=treatment.income.freq$income, ylim=c(0,50), las=2)
text(treatment.income.bp, 0, round(treatment.income.freq$freq, 1), cex=1, pos=3)
```

The majority of the subjects make income around $20,000 - $49,999 range. Treatment seems to have a slightly higher income overall but not by much.

#### 12. Have kids

```{r}
# have_kids frequency in the entire study
total.have_kids.freq <- d %>% 
  group_by(have_kids) %>% 
  summarize(freq = sum(n()))
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the have_kids frequency in the entire study
par(mar=c(8,3,1,1))
total.have_kids.bp <- barplot(total.have_kids.freq$freq, names.arg=total.have_kids.freq$have_kids, ylim=c(0,600), las=2)
text(total.have_kids.bp, 0, round(total.have_kids.freq$freq, 1), cex=1, pos=3)
```

```{r}
# have_kids frequency in the control group
control.have_kids.freq <- control %>% 
  group_by(have_kids) %>% 
  summarize(freq = sum(n())) 
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the have_kids frequency in the control group
par(mar=c(8,3,1,1))
control.have_kids.bp <- barplot(control.have_kids.freq$freq, names.arg=control.have_kids.freq$have_kids, ylim=c(0,250), las=2)
text(control.have_kids.bp, 0, round(control.have_kids.freq$freq, 1), cex=1, pos=3)
```

```{r}
# have_kids frequency in the treatment group
treatment.have_kids.freq <- treatment %>% 
  group_by(have_kids) %>% 
  summarize(freq = sum(n())) 
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the have_kids frequency in the treatment group
par(mar=c(8,3,1,1))
treatment.have_kids.bp <- barplot(treatment.have_kids.freq$freq, names.arg=treatment.have_kids.freq$have_kids, ylim=c(0,250), las=2)
text(treatment.have_kids.bp, 0, round(treatment.have_kids.freq$freq, 1), cex=1, pos=3)
```

There are slightly more subjects having kids than no kids but not by much.

#### 13. How often they access internet from their mobile phones

```{r}
internet_from_mobile.order <- c("I do not have a mobile phone", "Never", "Less than once a month", "Monthly", "Weekly", "Daily")
```

```{r}
# internet_from_mobile frequency in the entire study
total.internet_from_mobile.freq <- d %>% 
  group_by(internet_from_mobile) %>% 
  summarize(freq = sum(n())) %>%
  left_join(data.frame(internet_from_mobile=internet_from_mobile.order), .)
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the internet_from_mobile frequency in the entire study
par(mar=c(10,3,1,1))
total.internet_from_mobile.bp <- barplot(total.internet_from_mobile.freq$freq, names.arg=total.internet_from_mobile.freq$internet_from_mobile, ylim=c(0, 600), las=2)
text(total.internet_from_mobile.bp, 0, round(total.internet_from_mobile.freq$freq, 1), cex=1, pos=3)
```

```{r}
# internet_from_mobile frequency in the control group
control.internet_from_mobile.freq <- control %>% 
  group_by(internet_from_mobile) %>% 
  summarize(freq = sum(n())) %>%
  left_join(data.frame(internet_from_mobile=internet_from_mobile.order), .)
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the internet_from_mobile frequency in the control group
par(mar=c(10,3,1,1))
control.internet_from_mobile.bp <- barplot(control.internet_from_mobile.freq$freq, names.arg=control.internet_from_mobile.freq$internet_from_mobile, ylim=c(0,250), las=2)
text(control.internet_from_mobile.bp, 0, round(control.internet_from_mobile.freq$freq, 1), cex=1, pos=3)
```

```{r}
# internet_from_mobile frequency in the treatment group
treatment.internet_from_mobile.freq <- treatment %>% 
  group_by(internet_from_mobile) %>% 
  summarize(freq = sum(n())) %>%
  left_join(data.frame(internet_from_mobile=internet_from_mobile.order), .)
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the internet_from_mobile frequency in the treatment group
par(mar=c(10,3,1,1))
treatment.internet_from_mobile.bp <- barplot(treatment.internet_from_mobile.freq$freq, names.arg=treatment.internet_from_mobile.freq$internet_from_mobile, ylim=c(0,250), las=2)
text(treatment.internet_from_mobile.bp, 0, round(treatment.internet_from_mobile.freq$freq, 1), cex=1, pos=3)
```

The majority of the subjects access their phone daily.

#### 14. How often they access internet from home

```{r}
internet_from_home.order <- c("I do not have internet at my house", "Never", "Less than once a month", "Monthly", "Weekly", "Daily")
```

```{r}
# internet_from_home frequency in the entire study
total.internet_from_home.freq <- d %>% 
  group_by(internet_from_home) %>% 
  summarize(freq = sum(n())) %>%
  left_join(data.frame(internet_from_home=internet_from_home.order), .)
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the internet_from_home frequency in the entire study
par(mar=c(10,3,1,1))
total.internet_from_home.bp <- barplot(total.internet_from_home.freq$freq, names.arg=total.internet_from_home.freq$internet_from_home, ylim=c(0, 600), las=2)
text(total.internet_from_home.bp, 0, round(total.internet_from_home.freq$freq, 1), cex=1, pos=3)
```

```{r}
# internet_from_home frequency in the control group
control.internet_from_home.freq <- control %>% 
  group_by(internet_from_home) %>% 
  summarize(freq = sum(n())) %>%
  left_join(data.frame(internet_from_home=internet_from_home.order), .)
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the internet_from_home frequency in the control group
par(mar=c(10,3,1,1))
control.internet_from_home.bp <- barplot(control.internet_from_home.freq$freq, names.arg=control.internet_from_home.freq$internet_from_home, ylim=c(0,300), las=2)
text(control.internet_from_home.bp, 0, round(control.internet_from_home.freq$freq, 1), cex=1, pos=3)
```

```{r}
# internet_from_home frequency in the treatment group
treatment.internet_from_home.freq <- treatment %>% 
  group_by(internet_from_home) %>% 
  summarize(freq = sum(n())) %>%
  left_join(data.frame(internet_from_home=internet_from_home.order), .)
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the internet_from_home frequency in the treatment group
par(mar=c(10,3,1,1))
treatment.internet_from_home.bp <- barplot(treatment.internet_from_home.freq$freq, names.arg=treatment.internet_from_home.freq$internet_from_home, ylim=c(0,300), las=2)
text(treatment.internet_from_home.bp, 0, round(treatment.internet_from_home.freq$freq, 1), cex=1, pos=3)
```

The majority of the subjects access their internet daily from their home.

#### 15. How often they access internet from work

```{r}
internet_from_work.order <- c("I am currently not working", "Never", "Less than once a month", "Monthly", "Weekly", "Daily")
```

```{r}
# internet_from_work frequency in the entire study
total.internet_from_work.freq <- d %>% 
  group_by(internet_from_work) %>% 
  summarize(freq = sum(n())) %>%
  left_join(data.frame(internet_from_work=internet_from_work.order), .)
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the internet_from_work frequency in the entire study
par(mar=c(10,3,1,1))
total.internet_from_work.bp <- barplot(total.internet_from_work.freq$freq, names.arg=total.internet_from_work.freq$internet_from_work, ylim=c(0, 500), las=2)
text(total.internet_from_work.bp, 0, round(total.internet_from_work.freq$freq, 1), cex=1, pos=3)
```

```{r}
# internet_from_work frequency in the control group
control.internet_from_work.freq <- control %>% 
  group_by(internet_from_work) %>% 
  summarize(freq = sum(n())) %>%
  left_join(data.frame(internet_from_work=internet_from_work.order), .)
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the internet_from_work frequency in the control group
par(mar=c(10,3,1,1))
control.internet_from_work.bp <- barplot(control.internet_from_work.freq$freq, names.arg=control.internet_from_work.freq$internet_from_work, ylim=c(0,250), las=2)
text(control.internet_from_work.bp, 0, round(control.internet_from_work.freq$freq, 1), cex=1, pos=3)
```

```{r}
# internet_from_work frequency in the treatment group
treatment.internet_from_work.freq <- treatment %>% 
  group_by(internet_from_work) %>% 
  summarize(freq = sum(n())) %>%
  left_join(data.frame(internet_from_work=internet_from_work.order), .)
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the internet_from_work frequency in the treatment group
par(mar=c(10,3,1,1))
treatment.internet_from_work.bp <- barplot(treatment.internet_from_work.freq$freq, names.arg=treatment.internet_from_work.freq$internet_from_work, ylim=c(0,250), las=2)
text(treatment.internet_from_work.bp, 0, round(treatment.internet_from_work.freq$freq, 1), cex=1, pos=3)
```

The majority of the subjects access their internet daily from their work.

#### 16. Who pays the internet

```{r}
# who_pays_internet frequency in the entire study
total.who_pays_internet.freq <- d %>% 
  group_by(who_pays_internet) %>% 
  summarize(freq = sum(n()))
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the who_pays_internet frequency in the entire study
par(mar=c(8,3,1,1))
total.who_pays_internet.bp <- barplot(total.who_pays_internet.freq$freq, names.arg=total.who_pays_internet.freq$who_pays_internet, ylim=c(0,600), las=2)
text(total.who_pays_internet.bp, 0, round(total.who_pays_internet.freq$freq, 1), cex=1, pos=3)
```

```{r}
# who_pays_internet frequency in the control group
control.who_pays_internet.freq <- control %>% 
  group_by(who_pays_internet) %>% 
  summarize(freq = sum(n())) 
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the who_pays_internet frequency in the control group
par(mar=c(8,3,1,1))
control.who_pays_internet.bp <- barplot(control.who_pays_internet.freq$freq, names.arg=control.who_pays_internet.freq$who_pays_internet, ylim=c(0,250), las=2)
text(control.who_pays_internet.bp, 0, round(control.who_pays_internet.freq$freq, 1), cex=1, pos=3)
```

```{r}
# who_pays_internet frequency in the treatment group
treatment.who_pays_internet.freq <- treatment %>% 
  group_by(who_pays_internet) %>% 
  summarize(freq = sum(n())) 
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
# plot the who_pays_internet frequency in the treatment group
par(mar=c(8,3,1,1))
treatment.who_pays_internet.bp <- barplot(treatment.who_pays_internet.freq$freq, names.arg=treatment.who_pays_internet.freq$who_pays_internet, ylim=c(0,250), las=2)
text(treatment.who_pays_internet.bp, 0, round(treatment.who_pays_internet.freq$freq, 1), cex=1, pos=3)
```

The majority of the subjects pay internet by themselves. 

#### 17. Click counts

```{r}
# summary of click count per control question
summary(control$control_employment_Click.Count)
summary(control$control_education_Click.Count)
summary(control$control_retirement_Click.Count)
summary(control$control_cybersecurity_Click.Count)
```

```{r}
# summary of click count per treatment question
summary(treatment$treatment_employment_Click.Count)
summary(treatment$treatment_education_Click.Count)
summary(treatment$treatment_retirement_Click.Count)
summary(treatment$treatment_cybersecurity_Click.Count)
```


```{r out.width="49%", fig.align="center", fig.show="hold"}
boxplot(control$control_employment_Click.Count,
  control$control_education_Click.Count,
  control$control_retirement_Click.Count,
  control$control_cybersecurity_Click.Count, 
  main="control's click count",
  names=c("employment", "education\n(baseline)", "retirement", "cybersecurity"))

boxplot(treatment$treatment_employment_Click.Count,
  treatment$treatment_education_Click.Count,
  treatment$treatment_retirement_Click.Count,
  treatment$treatment_cybersecurity_Click.Count, 
  main="treatment's click count",
  names=c("employment", "education\n(baseline)", "retirement", "cybersecurity"))
```

There are slightly more clicks in treatment than in control, but both follow the same distribution, which is high click counts, on average, for the first question then decreasing the number of click counts until the third question before rising up on the fourth question. 

#### 18. Length of time spent on each question

Since we supress the next button for 30 seconds, we should see that each subject spends on each question 30 seconds or longer. 

use _Page.Submit instead of _Last.Click
time = _Page.Submit - _First.Click

```{r}
# determine how long each subject takes to answer the question (in seconds)
control$control_employment_Duration.in.sec <- 
  control$control_employment_Page.Submit - control$control_employment_First.Click
control$control_education_Duration.in.sec <-
  control$control_education_Page.Submit - control$control_education_First.Click
control$control_retirement_Duration.in.sec <- 
  control$control_retirement_Page.Submit - control$control_retirement_First.Click
control$control_cybersecurity_Duration.in.sec <- 
  control$control_cybersecurity_Page.Submit - control$control_cybersecurity_First.Click

treatment$treatment_employment_Duration.in.sec <- 
  treatment$treatment_employment_Page.Submit - treatment$treatment_employment_First.Click
treatment$treatment_education_Duration.in.sec <-
  treatment$treatment_education_Page.Submit - treatment$treatment_education_First.Click
treatment$treatment_retirement_Duration.in.sec <- 
  treatment$treatment_retirement_Page.Submit - treatment$treatment_retirement_First.Click
treatment$treatment_cybersecurity_Duration.in.sec <- 
  treatment$treatment_cybersecurity_Page.Submit - treatment$treatment_cybersecurity_First.Click
```

```{r}
# summary of duration per control question
summary(control$control_employment_Duration.in.sec)
summary(control$control_education_Duration.in.sec)
summary(control$control_retirement_Duration.in.sec)
summary(control$control_cybersecurity_Duration.in.sec)
```

```{r}
# summary of duration per treatment question
summary(treatment$treatment_employment_Duration.in.sec)
summary(treatment$treatment_education_Duration.in.sec)
summary(treatment$treatment_retirement_Duration.in.sec)
summary(treatment$treatment_cybersecurity_Duration.in.sec)
```

```{r out.width="49%", fig.align="center", fig.show="hold"}
boxplot(control$control_employment_Duration.in.sec,
  control$control_education_Duration.in.sec,
  control$control_retirement_Duration.in.sec,
  control$control_cybersecurity_Duration.in.sec, 
  main="control's duration (sec) in each question",
  names=c("employment", "education\n(baseline)", "retirement", "cybersecurity"))

boxplot(treatment$treatment_employment_Duration.in.sec,
  treatment$treatment_education_Duration.in.sec,
  treatment$treatment_retirement_Duration.in.sec,
  treatment$treatment_cybersecurity_Duration.in.sec, 
  main="treatment's duration (sec) in each question",
  names=c("employment", "education\n(baseline)", "retirement", "cybersecurity"))
```

On average, it takes the treatment group much longer to complete the question than the control group.

```{r}
# number of subjects in control who took each question less than 30 seconds
nrow(control[which(control$control_employment_Duration.in.sec < 30),])
nrow(control[which(control$control_education_Duration.in.sec < 30),])
nrow(control[which(control$control_retirement_Duration.in.sec < 30),])
nrow(control[which(control$control_cybersecurity_Duration.in.sec < 30),])
```

```{r}
# number of subjects in control
nrow(control)
```

```{r}
# number of subjects in treatment who toko each question less than 30 seconds
nrow(treatment[which(treatment$treatment_employment_Duration.in.sec < 30),])
nrow(treatment[which(treatment$treatment_education_Duration.in.sec < 30),])
nrow(treatment[which(treatment$treatment_retirement_Duration.in.sec < 30),])
nrow(treatment[which(treatment$treatment_cybersecurity_Duration.in.sec < 30),])
```

```{r}
# number of subjects in treatment
nrow(treatment)
```

### Cross Section of Covariates

**TODO**

a pre-analysis/EDA, just looking at some plots of scores for each answer, with a few cuts by covariates (e.g. histograms by political preference, gender; box-whisker plots for age groups, etc.)

1. age x gender

2. Employment: age x employment, gender x employment, ethnicity x employment, educ x employment

```{r out.width="49%", fig.align="center", fig.show="hold"}
# cross section of education vs employment
educXemp <- d %>% 
  group_by(highest_education, employment_status) %>% 
  summarize(freq = sum(n()))

```

3. Income: ... x income: should see similar result as ... x employment

4. Community: married x community, have_kids x community

5. Party: age x party, gender x party, ethnicity x party, educ x party, income x party, community x party
   can_vote x party
6. 

### Analysis of each research question

2) then, for each question, starting with our education placebo test, we have a _stargazer_ output that has 3 regressions: a) with only the treatment dummy, b) with treatment plus key covariates, and c) with treatment, key covariates AND interaction terms (i.e. HTEs)

* Important covariate always included: political_party, can_vote

* Key covarites for each question:

  * employment: income, employment_status

  * (baseline) education: income, highest_education

  * retirement: income, age

  * cybersecurity: internet_from_mobile, internet_from_home, internet_from_work, who_pays_internet

* other covariates: gender, age, ethnicity, marital_status, have_kids, zip_code, click_counts, duration

all covariates: gender, age, highest_education, employment_status, marital_status, zip_code, community, can_vote, political_party, ethnicity, income, have_kids, internet_from_mobile, internet_from_home, internet_from_work, who_pays_internet, click_counts, duration

#### (Baseline) Education

Education is the second question we asked in both treatment and control. It acts as our baseline because it does not include the name of our president. 

```{r}
# control
```

```{r}
# treatment
```




#### Employment

#### Retirement

#### Cybersecurity


## References

1. renaming column names: http://rprogramming.net/rename-columns-in-r/ 

## Unused stuff

### IP
Get state, country information from IPs. IPs are not reliable though. Plus, it's dang slow.

```
freegeoip <- function(ip, format = ifelse(length(ip)==1,'list','dataframe'))
{
    if (1 == length(ip))
    {
        # a single IP address
        url <- paste(c("http://api.ipstack.com/", ip, "?access_key=0e93a4defcd645bd8829ad75a7223437&output=json&legacy=1/"), collapse='')
        ret <- fromJSON(readLines(url, warn=FALSE))
        if (format == 'dataframe')
            ret <- data.frame(t(unlist(ret)))
        return(ret)
    } else {
        ret <- data.frame()
        for (i in 1:length(ip))
        {
            r <- freegeoip(ip[i], format="dataframe")
            ret <- bind_rows(ret, r)
        }
        return(ret)
    }
}   

try.ip <- function(ip) {
  suppressWarnings(try(freegeoip(ip), silent = TRUE))
}

ips <- try.ip(data$IPAddress)
```

### LatLong

Get state, country information from Google API. Unfortunately, it's taking too long and Google has a limit for the number of API calls.

How to call the API via the browser:
https://maps.googleapis.com/maps/api/geocode/json?latlng=40.714224,-73.961452&key=AIzaSyC8Q7FY6SzmEfpMTOcx2BTrnYaRkzX12Ik

How to call the API via R:
```
library(revgeo)
revgeo(longitude=-73.961452, latitude=40.714224, output="frame", provider="google", API="AIzaSyC8Q7FY6SzmEfpMTOcx2BTrnYaRkzX12Ik")
```

This will always fail because of the limitation to the number of API calls:
```
ll <- revgeo(longitude = data$LocationLongitude, latitude = data$LocationLatitude, output = "frame", provider = "google", API = "AIzaSyC8Q7FY6SzmEfpMTOcx2BTrnYaRkzX12Ik")
```

Getting USA (or any other country)'s latlong

```
library(ggmap)
geocode("USA")
```
